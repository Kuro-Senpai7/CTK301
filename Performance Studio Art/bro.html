<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>AR.js with Text Box</title>
  <script src="https://aframe.io/releases/1.2.0/aframe.min.js"></script>
  <script src="https://cdn.jsdelivr.net/gh/AR-js-org/AR.js/aframe/build/aframe-ar.js"></script>
  <style>
    body { margin: 0; }
    #container { width: 100vw; height: 100vh; }
  </style>
</head>
<body>
  <div id="container">
    <a-scene embedded arjs>
      <!-- Marker -->
      <a-marker preset="hiro">
        <!-- 3D object -->
        <a-box position="0 0.5 0" material="color: red;"></a-box>
        <!-- Text box -->
        <a-text id="text-box" value="Hello, AR!" position="0 1 0" align="center" color="white" width="4"></a-text>
      </a-marker>
      <a-entity camera></a-entity>
    </a-scene>
  </div>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const startingPosition = { x: 0, y: 0, z: 0 }; // Default position

      function updatePosition() {
        const cameraEl = document.querySelector('[camera]');
        const cameraPosition = cameraEl.getAttribute('position');

        // Set the initial position
        if (!startingPositionSet) {
          startingPosition.x = cameraPosition.x;
          startingPosition.y = cameraPosition.y;
          startingPosition.z = cameraPosition.z;
          startingPositionSet = true;
        }

        // Adjust positions relative to the starting point
        const textBoxEl = document.querySelector('#text-box');
        const relativePosition = {
          x: textBoxEl.getAttribute('position').x - (cameraPosition.x - startingPosition.x),
          y: textBoxEl.getAttribute('position').y - (cameraPosition.y - startingPosition.y),
          z: textBoxEl.getAttribute('position').z - (cameraPosition.z - startingPosition.z)
        };

        textBoxEl.setAttribute('position', relativePosition);
      }

      let startingPositionSet = false;
      document.querySelector('a-scene').addEventListener('loaded', () => {
        setInterval(updatePosition, 100); // Update position every 100ms
      });
    });
  </script>
</body>
</html>
